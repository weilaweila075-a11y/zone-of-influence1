<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Zone of Influence — Онлайн игра</title>
<style>
body{margin:0;font-family:Arial;background:#121212;color:#eee}
.game{max-width:1100px;margin:auto;padding:20px}
.panel{background:#1e1e1e;padding:15px;border-radius:8px;box-shadow:0 0 10px #000;position:relative}
#playerAvatar{width:80px;height:80px;background:#444;border-radius:50%;margin-bottom:10px;animation:idle 1s infinite alternate;}
@keyframes idle{0%{transform:translateY(0);}100%{transform:translateY(-5px);}}
.effect{position:absolute;width:20px;height:20px;border-radius:50%;background:red;animation:hit 0.5s ease-out;pointer-events:none;}
@keyframes hit{0%{transform:scale(1);opacity:1;}100%{transform:scale(2);opacity:0;}}
.item{background:#2a2a2a;padding:6px;margin:4px 0;border-radius:4px;transition:0.2s}
.item:hover{background:#444;transform:scale(1.05);}
button{margin:3px;padding:6px 12px;background:#333;color:#fff;border:none;border-radius:4px;cursor:pointer;}
button:hover{background:#555;}
</style>
</head>
<body>
<div class="game">
<div id="gamePanel" class="panel">
<div>
<div id="playerAvatar"></div>
<h3 id="areaName"></h3>
<p id="areaDesc"></p>
<button onclick="task()">Занятие (-1 энергия)</button>
<button onclick="fightNPC()">Разборка (-2 энергия)</button>
<button onclick="bossFight()">Лидер района (-3 энергия)</button>
</div>
<div>
<h3>Персонаж</h3>
<p>Имя: <span id="usernameDisplay"></span></p>
<p>Бригада: <span id="brigadeName">—</span></p>
<p>Выносливость: <span id="energy"></span></p>
<p>Уважение: <span id="respect"></span></p>
<p>Респект: <span id="rep"></span></p>
<p>Деньги: <span id="money"></span></p>
<h4>Инвентарь</h4>
<div id="inv"></div>
<button onclick="buyItem()">Купить предмет (20$)</button>
</div>
<div>
<h3>PvP / Бригады</h3>
<button onclick="pvpFight()">Напасть на игрока (-2)</button>
<button onclick="brigadeFight()">Битва бригад (-5)</button>
<p id="pvpLog"></p>
</div>
</div>
</div>
<script>
let player={};
const areas=[{name:'Нижний сектор',desc:'Начальный район',need:0},{name:'Промзона',desc:'Опаснее, но прибыльнее',need:20},{name:'Центр влияния',desc:'Высший уровень',need:60}];
let currentArea=0;

function loadProfile(token){
    let saved = localStorage.getItem('zonePlayer');
    player = saved ? JSON.parse(saved) : {};
    if(!player.username) player.username='Игрок';
    if(!player.energy) player.energy=10;
    if(!player.respect) player.respect=0;
    if(!player.rep) player.rep=0;
    if(!player.money) player.money=30;
    if(!player.inventory) player.inventory=[];
    if(!player.brigade) player.brigade=null;
    save();
    update();
}

function save(){localStorage.setItem('zonePlayer',JSON.stringify(player));}

const energyEl=document.getElementById('energy');
const respectEl=document.getElementById('respect');
const repEl=document.getElementById('rep');
const moneyEl=document.getElementById('money');
const areaName=document.getElementById('areaName');
const areaDesc=document.getElementById('areaDesc');
const inv=document.getElementById('inv');
const pvpLog=document.getElementById('pvpLog');
const brigadeName=document.getElementById('brigadeName');
const usernameDisplay=document.getElementById('usernameDisplay');
const avatar=document.getElementById('playerAvatar');

function spawnEffect(){const e=document.createElement('div');e.className='effect';avatar.appendChild(e);setTimeout(()=>e.remove(),500);}

function update(){
    energyEl.textContent=player.energy;
    respectEl.textContent=player.respect;
    repEl.textContent=player.rep;
    moneyEl.textContent=player.money;
    brigadeName.textContent=player.brigade||'—';
    usernameDisplay.textContent=player.username;
    areaName.textContent='Район: '+areas[currentArea].name;
    areaDesc.textContent=areas[currentArea].desc;
    inv.innerHTML=player.inventory.map(i=>`<div class='item'>${i}</div>`).join('')||'Пусто';
    save();
}

function task(){if(player.energy<1)return alert('Нет энергии');player.energy--;player.respect+=2;player.money+=5;spawnEffect();update();}
function fightNPC(){if(player.energy<2)return alert('Нет энергии');player.energy-=2;player.respect+=3;player.rep++;spawnEffect();update();}
function bossFight(){if(player.energy<3)return alert('Нет энергии');player.energy-=3;player.respect+=10;player.rep+=3;player.money+=20;player.inventory.push('Редкий предмет');spawnEffect();update();}
function buyItem(){if(player.money<20)return alert('Нет денег');player.money-=20;player.inventory.push('Снаряжение');spawnEffect();update();}
function pvpFight(){if(player.energy<2)return alert('Нет энергии');player.energy-=2;player.respect+=Math.floor(Math.random()*5);spawnEffect();update();pvpLog.textContent='PvP боец +'+Math.floor(Math.random()*5)+' уважения';}
function brigadeFight(){if(player.energy<5)return alert('Нет энергии');player.energy-=5;player.respect+=Math.floor(Math.random()*10);spawnEffect();update();pvpLog.textContent='Битва бригад +'+Math.floor(Math.random()*10)+' уважения';}

setInterval(()=>{if(player.energy<10){player.energy++;update();}},5000);

// Загружаем профиль сразу без VK
loadProfile('test-token');
</script>
</body>
</html>
